---
title: "MAN IN THE MIDDLE ATTACK"
layout: post
---


**1. Giao thức ARP**

Đây là một giao thức mạng dùng để tìm ra địa chỉ MAC của một thiết bị từ một IP nguồn.
VD: Thiết bị sẽ gửi 1 ARP request chưa IP của thiết bị nhận. Tất cả các mạng trong local network sẽ nhận đc gói tin nhưng chỉ có thiết bị khớp với IP trong gói ARP mới có thể phản hồi lại thông tin với thông điệp chứa địa chỉ MAC của nó.

**2. ARP Spoofing**

![ARP SPOOFING DIAGRAM](https://dsm01pap003files.storage.live.com/y4mF4Cj0m0f88khpHqP9g5cE9dUjUv3O8uMex1DlpNnTBfCrvZs3Jwp-wh9GYsOTdr_PwLvsiuh-Ooa2X-0obMbBl-6Uct0YWsvsaAxCiEz1vAb48IyOJJ-dWn-vI7O2DYY7AxfN7QQzGDb3Mnh6qwQhWEaWQCG_TzD_R0ybvqgV9rgLO6bczPm4-L8Ey9sA5ZrUVhOEtP9OrYuLfRtHHeY00yXBfph61Kv3gghUXQof20?width=570&height=295&cropmode=center)

ARP Spoofing cho phép chuyển hướng các packet cho nên thay vì các packet được gửi thẳng đến máy victim (như sơ đồ), nó sẽ đi qua máy tính của hacker. Như vậy các request cũng như respond sẽ đều phải đi qua máy tính của hacker → Cho phép hacker đọc, chỉnh sửa cũng như chặn các gói tin này.

**3. ARPSPOOF Tool**

Máy thực hiện tấn công: Kali linux 2022
Máy mục tiêu: Windows 10
Để hiển thị bảng dữ liệu arp, chúng ta sử dụng lệnh: arp -a


![arp-a command](https://dsm01pap003files.storage.live.com/y4mmbreHb3jLMQUv_VbUu8qTytNZrJiLXlc8GGAc4ZLswe5m0Sc8YpBjjsxXaxtTLLBrKE2tNZlMTxCNaBhxvJ0MO7sIZoEOOGgnTFZZRGnnc7zEsl3mz_JESvaLZAkkFalQVPVlSfaE7UnjXGziE9ADuLF6ToxDwWrVql9BGhemdBpJ1Aja3abAXeHiZi-LWdgUg4tBNzoKEigjzZ4Vf6W4v082UjZVnh_jPKL5ts6U9U?encodeFailures=1&width=622&height=99)

Sử dụng arpspoof:
**arpspoof -i [name_interface] -t [IP_victim] [IP_gateway]**: Gửi request đến máy nạn nhân nói rằng mình là router
**arpspoof -i [name_interface] -t [IP_victim] [IP_gateway]** Gửi request đến router nói rằng mình là máy victim

![Thực hiện chạy đồng thời](https://dsm01pap003files.storage.live.com/y4mp7nXvbDiG7iL79j6b6-xYkLCXkNGyniUPj9-I3J7GC3cbMFeoBoGvYjOCAEAIK4GnUatWlVKJ8MiP4fUNNtf11DuqzsOb4XE6GCfn7uKAAW0WqaTmQWe0ExBhVBhMsltOtKQ-rqlFZ1EicJP2G9r-NJrhXbief0_iwnhobdzGh7ND5p2ZQWpYYCk4ZzORhAtguJT1HinI8--lwwzX-FODy6VXVPDcIgnN6-M2zvWHyw?encodeFailures=1&width=622&height=225)

![Kết quả bảng arp máy windows 10](https://dsm01pap003files.storage.live.com/y4mGx4BSzVSE2MNv5fsftE8kJ_UX_t_1RvXI2Dh4_1wvv5JftoZsHK4bAyPehrm8aJTcdtyduYSr3OCFAx9KR24iBijghpB4R4tv6WQR8cB3u6K0dkpicbr-rNYIBz1rKQbWc4OghcmFKxagf-yOQoxQmt4mjP1NL7GUPYF0SDIdvTd1y2oc7moLBguP72Yr1EBn_fWPnbn_Fj-9LrUhB07vaprFlUPY_x4MKLUJXwl_mE?encodeFailures=1&width=561&height=327)
